# 画面遷移図

## 概要
タスク管理アプリケーションの画面間の遷移関係を図とテキストで表現します。

## 画面遷移図（Mermaid記法）

```mermaid
graph TD
    HOME[ホーム画面<br/>"/"]
    TASK_LIST[タスク一覧画面<br/>"/tasks"]
    TASK_DETAIL[タスク詳細画面<br/>"/tasks/:id"]
    TASK_NEW[タスク新規作成画面<br/>"/tasks/new"]
    TASK_EDIT[タスク編集画面<br/>"/tasks/:id/edit"]

    %% ナビゲーションからの遷移
    HOME -->|"タスク一覧を見る"| TASK_LIST
    HOME -->|"新規タスク作成"| TASK_NEW
    TASK_LIST -->|"ナビゲーション"| HOME
    TASK_DETAIL -->|"ナビゲーション"| HOME
    TASK_NEW -->|"ナビゲーション"| HOME
    TASK_EDIT -->|"ナビゲーション"| HOME

    %% タスク一覧からの遷移
    TASK_LIST -->|"新規作成ボタン"| TASK_NEW
    TASK_LIST -->|"詳細ボタン"| TASK_DETAIL
    TASK_LIST -->|"編集ボタン"| TASK_EDIT

    %% タスク詳細からの遷移
    TASK_DETAIL -->|"戻るリンク"| TASK_LIST
    TASK_DETAIL -->|"編集ボタン"| TASK_EDIT
    TASK_DETAIL -->|"削除ボタン<br/>(削除後)"| TASK_LIST

    %% タスク作成からの遷移
    TASK_NEW -->|"作成完了"| TASK_DETAIL
    TASK_NEW -->|"キャンセル"| TASK_LIST

    %% タスク編集からの遷移
    TASK_EDIT -->|"更新完了"| TASK_DETAIL
    TASK_EDIT -->|"キャンセル"| TASK_DETAIL

    %% スタイリング
    classDef homeStyle fill:#e1f5fe
    classDef listStyle fill:#f3e5f5
    classDef detailStyle fill:#e8f5e8
    classDef formStyle fill:#fff3e0

    class HOME homeStyle
    class TASK_LIST listStyle
    class TASK_DETAIL detailStyle
    class TASK_NEW,TASK_EDIT formStyle
```

## 画面遷移詳細

### 1. ホーム画面 (HOME) からの遷移

| 遷移先 | トリガー | 方法 | 備考 |
|--------|----------|------|------|
| タスク一覧画面 | 「タスク一覧を見る」ボタンクリック | Link遷移 | メイン機能への導線 |
| タスク新規作成画面 | 「新規タスク作成」ボタンクリック | Link遷移 | 直接作成への導線 |

### 2. タスク一覧画面 (TASK_LIST) からの遷移

| 遷移先 | トリガー | 方法 | 備考 |
|--------|----------|------|------|
| ホーム画面 | ナビゲーション「ホーム」クリック | Link遷移 | 共通ナビゲーション |
| タスク新規作成画面 | 「新規作成」ボタンクリック | Link遷移 | ナビゲーションまたはページ内ボタン |
| タスク詳細画面 | 「詳細」ボタンクリック | Link遷移 | URLパラメータでタスクID指定 |
| タスク編集画面 | 「編集」ボタンクリック | Link遷移 | URLパラメータでタスクID指定 |

### 3. タスク詳細画面 (TASK_DETAIL) からの遷移

| 遷移先 | トリガー | 方法 | 備考 |
|--------|----------|------|------|
| ホーム画面 | ナビゲーション「ホーム」クリック | Link遷移 | 共通ナビゲーション |
| タスク一覧画面 | ナビゲーション「タスク一覧」クリック | Link遷移 | 共通ナビゲーション |
| タスク一覧画面 | 「← タスク一覧に戻る」リンククリック | Link遷移 | 専用戻りリンク |
| タスク編集画面 | 「編集」ボタンクリック | Link遷移 | 同一タスクの編集 |
| タスク一覧画面 | 「削除」ボタンクリック（削除完了後） | useNavigate | 削除処理後の自動遷移 |

### 4. タスク新規作成画面 (TASK_NEW) からの遷移

| 遷移先 | トリガー | 方法 | 備考 |
|--------|----------|------|------|
| ホーム画面 | ナビゲーション「ホーム」クリック | Link遷移 | 共通ナビゲーション |
| タスク一覧画面 | ナビゲーション「タスク一覧」クリック | Link遷移 | 共通ナビゲーション |
| タスク一覧画面 | 「キャンセル」ボタンクリック | Link遷移 | 作成取消時 |
| タスク詳細画面 | 「作成」ボタンクリック（作成完了後） | redirect | 作成したタスクの詳細画面 |

### 5. タスク編集画面 (TASK_EDIT) からの遷移

| 遷移先 | トリガー | 方法 | 備考 |
|--------|----------|------|------|
| ホーム画面 | ナビゲーション「ホーム」クリック | Link遷移 | 共通ナビゲーション |
| タスク一覧画面 | ナビゲーション「タスク一覧」クリック | Link遷移 | 共通ナビゲーション |
| タスク詳細画面 | 「キャンセル」ボタンクリック | Link遷移 | 編集取消時 |
| タスク詳細画面 | 「更新」ボタンクリック（更新完了後） | redirect | 更新したタスクの詳細画面 |

## 特殊な遷移パターン

### エラー処理による遷移

| ケース | 発生画面 | 遷移先 | トリガー |
|--------|----------|--------|----------|
| タスクが見つからない | タスク詳細画面 | エラー表示（同一画面内） | 無効なタスクIDでのアクセス |
| タスクが見つからない | タスク編集画面 | エラー表示（同一画面内） | 無効なタスクIDでのアクセス |
| API接続エラー | 各画面 | エラーメッセージ表示 | API通信失敗時 |

### 認証・認可（将来拡張用）
現在は実装されていませんが、将来の認証機能追加時の遷移パターン：

| ケース | 遷移元 | 遷移先 | 備考 |
|--------|--------|--------|------|
| 未認証アクセス | 任意の画面 | ログイン画面 | 認証が必要な機能へのアクセス時 |
| ログイン成功 | ログイン画面 | アクセス元画面またはホーム | 認証完了後の復帰 |

## 技術的な実装詳細

### 遷移方法の種類

1. **Link遷移**
   - `<Link to="/path">` コンポーネントを使用
   - 通常のページ遷移に使用
   - React Router DOM v6.28.0対応

2. **プログラム遷移**
   - `useNavigate()` フックを使用
   - フォーム送信後やAPI処理後の自動遷移に使用

3. **Redirect**
   - `navigate()` 関数を使用
   - プログラム的な遷移制御に使用

### URLパラメータ

- **動的ルート**: `/tasks/:id` 形式でタスクIDを指定
- **パラメータ取得**: `useParams()` フックでアクセス

### 状態の引き継ぎ

- **フォームデータ**: React stateとAPI連携での状態管理
- **ページデータ**: useEffectとAPI呼び出しでデータ取得
- **ナビゲーション状態**: useNavigateフックで遷移制御